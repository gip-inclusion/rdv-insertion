<% if user_is_archived && !department_level? %>
  <% confirm_content = capture do %>
    Êtes vous sûr ? <br/><br/>Le dossier de <b><%= user %></b> sera rouvert dans l'organisation <b><%= current_organisation&.name %></b> et retrouvera le statut précédant l'archivage.
  <% end %>
  <%=
    link_to(
      "Rouvrir le dossier",
      # in this case we are at organisation level, there is always only one archive
      organisation_archive_path(current_organisation, user.archive_in_organisation(current_organisation)),
      class: "btn btn-blue", id: "archive-button",
      data: { turbo_confirm: confirm_modal(title: "Rouvrir le dossier dans cette organisation ?", action: "Rouvrir le dossier", content: confirm_content), turbo_method: :delete }
    )
  %>
<% else %>
  <span class="tooltip-wrapper" data-controller="tooltip" data-action="mouseover->tooltip#archivingDisabled">
    <%=
      link_to(
        "Archiver le dossier",
        new_structure_user_archive_path(user_id: user.id),
        class: "btn btn-blue #{"disabled" if user_is_archived}", id: "archive-button",
        data: { turbo_frame: 'remote_modal' },
      )
    %>
  </span>
<% end %>
